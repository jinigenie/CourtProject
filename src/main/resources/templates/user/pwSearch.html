<!DOCTYPE html>
<html>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
	crossorigin="anonymous"></script>

<head>
	<title>아이디 찾기</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background: #f7f7f7;
		}

		.container {
			max-width: 400px;
			height: 290px;
			margin: 0 auto;
			padding: 20px 40px;
			background-color: #fff;
			border-radius: 5px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			align-items: center;
			display: none;
		}

		h2 {
			text-align: center;
			color: #007BFF;
		}

		label {
			text-align: right;
			font-size: 15px;
			display: block;
			float: left;
			padding-top: 7px;
		}


		.input-group {
			overflow: hidden;
			text-align: center;
			align-items: center;
		}


		#name,
		#phone {
			display: block;
			float: left;
			width: 200px;
			height: 16px;
			padding: 10px;
			margin-bottom: 10px;
			border: 1px solid #ddd;
			border-radius: 3px;
			flex: 3;
			margin-left: 10px;

		}

		#verificationCode {
			display: block;
			float: left;
			width: 200px;
			height: 10px;
			padding: 10px;
			margin-bottom: 10px;
			border: 1px solid #ddd;
			border-radius: 3px;
			flex: 3;
			margin-left: 10px;

		}






		button[type="submit"] {
			width: 100%;
			padding: 10px;
			background: #007BFF;
			color: #fff;
			border: none;
			font-size: 1rem;
			text-align: center;
			border-radius: 3px;
			cursor: pointer;
		}

		button[type="submit"]:hover {
			background-color: #0056b3;
		}

		/* 추가 스타일링 */
		.auth-form {
			overflow: hidden;
			text-align: center;
			align-items: center;

		}

		.auth-form.show {
			display: block;
		}

		/*전송버튼*/
		#verifyButton,
		#findIdButton {
			margin-top: 10px;
			margin-left: 5px;
			border: 1px solid #ccc;
			background-color: white;
			float: left;
			font-size: 11px;
			width: 75px;
			height: 27px;
			border-radius: 3px;

		}

		#verifyButton,
		#findIdButton:hover {
			cursor: grab;
		}

		#findIdButton2 {
			cursor: pointer;
			margin-top: 20px;
			text-decoration: none;
			display: block;
			text-align: center;
			height: 40px;
			width: 170px;
			font-size: 16px;
			background-color: white;
			border: 1px solid #ccc;
			border-radius: 5px;

		}

		.btn_div {
			display: flex;
			padding: 0px 130px;
		}
	</style>
</head>

<body>
	<div class="container">
		<h2>비밀번호 찾기</h2>
		<form id="findIdForm">
			<div class="input-group">
				<label for="name" style="padding-left: 26px;">아이디 :</label>
				<input type="text" id="name" name="name" placeholder="이름을 입력하세요">
			</div>

			<div class="input-group">
				<label for="phone">휴대폰 번호:</label>
				<input type="text" id="phone" name="phone" placeholder="'-'을 제외한 11자리 번호를 입력해주세요">
				<button type="button" id="verifyButton">인증번호전송</button>
			</div>

			<div class="auth-form">
				<label for="verificationCode" style="padding-left: 17px;">인증번호:</label>
				<input type="text" id="verificationCode" name="verificationCode">
				<button type="button" id="findIdButton" style="margin-top: 5px;">인증번호확인</button>
			</div>
			<div class="btn_div">
				<button type="button" id="findIdButton2">비밀번호변경</button>
			</div>
		</form>
	</div>
	<div class="container result" style="display: block; ">
				<h2 style="padding-left: 15px;">새 비밀번호설정</h2><br/>
				
		<form id="findIdForm" style="padding-left: 30px;">
			<div class="input-group">
				<label for="name" style="padding-left: 26px;">비밀번호 :</label>
				<input type="text" id="name" name="name" placeholder="비밀번호를 입력하세요">
			</div>

			<div class="input-group">
				<label for="phone">비밀번호 확인:</label>
				<input type="text" id="phone" name="phone" placeholder="다시한번 입력해주세요">
			</div>
			<br/>
			<div class="btn_div">
				<button type="button" id="findIdButton2">비밀번호변경</button>
			</div>
		</form>
	</div>

	<script>
		const verifyButton = document.getElementById('verifyButton');
		const findIdButton = document.getElementById('findIdButton');
		const authForm = document.querySelector('.auth-form');

		//폰 인증받기
		let certification = 0;
		let check = false;
		$("#verifyButton").click(() => {
			const phone = $('#phone').val();
			$.ajax({
				url: "send-one",
				method: "POST",
				data: {
					"phone": phone
				},
				dataType: "json",
				success: (data) => {
					console.log("통신전에 찍기", certification);
					console.log(data);
					certification = data;
					console.log("통신하고 나서 콘솔", certification);
				},
				error: (status, error) => {
					console.log(status, error);
				}
			})
		})

		$("#findIdButton").click(() => {

			let checkNumber = $('#verificationCode').val();
			console.log(certification, checkNumber);
			if (checkNumber == certification && checkNumber!=='') {
				console.log(check);
				alert("인증되었습니다.")
				check = true;
				console.log(check);

			} else {
				alert("인증실패")
				check = false;
			}
		})

		$('#findIdButton2').click(() => {
			if (check) {
				$.ajax({
					url : "searchId",
					method : "POST",
					data : {
						"phone" : $('#phone').val()
					},
					success : (data)=>{
						//$('.container').hide();
						//$('.result').show();
					},
					error : (status,error)=>{
						console.log(status, error);
					}
				})
			}else {
				alert("인증번호 재확인 바랍니다.")
			}
		})


		$('#updatePw').click(() => {
			
				$.ajax({
					url : "updatePw",
					method : "POST",
					data : {
						"newPw" : $('#newPw').val(),
						"phone" : $('#phone').val()
					},
					success : (data)=>{
						console.log("변경")
					},
					error : (status,error)=>{
						console.log(status, error);
					}
				})
		})
	</script>
</body>

</html>