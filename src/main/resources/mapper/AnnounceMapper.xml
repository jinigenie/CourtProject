<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.court.proj.announce.AnnounceMapper">

	<!-- tb_002, tb_010, tb_015 공고 리스트 조회 -->
	<select id="getannounceList" resultType="AnnounceVO">
		select
		a.announce_proper_num,
		a.admin_proper_num,
		b.admin_id,
		b.admin_pw,
		b.admin_auth,
		b.admin_name,
		a.trial_fcltt_proper_num,
		c.trial_fcltt_main_code,
		c.trial_fcltt_clasifi_code,
		c.trial_fcltt_sbcls_code,
		c.trial_fcltt_description,
		a.announce_title,
		a.announce_content,
		a.announce_start_date,
		a.announce_end_date,
		a.announce_first_date,
		a.announce_last_date
		from TB_002 a
		inner join
		TB_015 b on a.admin_proper_num = b.admin_proper_num
		inner join tb_010 c
		on a.trial_fcltt_proper_num = c.trial_fcltt_proper_num
		order by
		a.announce_proper_num;
	</select>

	<select id="getTotal" resultType="int">
		select count(*) from TB_002
	</select>

	<select id="getinfo" resultType="AnnounceVO">
		select * from TB_015 where
		admin_id = #{admin_id}
	</select>

	<!-- 검색기능 start -->
	<select id="searchAnnounceByTitleandContent"
		resultType="AnnounceVO">
		select * from TB_002
		where announce_title LIKE '%' ||
		#{keyword} || '%' OR announce_content LIKE
		'%' || #{keyword} || '%'
	</select>

	<select id="searchAnnounceByTitle" resultType="AnnounceVO">
		select * from
		TB_002
		where announce_title LIKE '%' || #{keyword} || '%'
	</select>

	<select id="searchAnnounceByContent" resultType="AnnounceVO">
		select * from
		TB_002
		where announce_content LIKE '%' || #{keyword} || '%'
	</select>

	<!-- 재판조력자 분로 start -->
	<select id="getTrial" resultType="TrialVO">
		select * from TB_010
	</select>

	<select id="getTrialVO" resultType="TrialVO">
		select * from TB_010 where
		trial_fcltt_proper_num = #{trial_fcltt_proper_num}
	</select>

	<select id="getTrialNum1" resultType="int">
		select * from TB_010 where
		trial_fcltt_main_code = #{arg0}
		and trial_fcltt_clasifi_code = #{arg1}
	</select>

	<select id="getTrialNum2" resultType="int">
		select * from TB_010 where
		trial_fcltt_main_code = #{arg0}
		and trial_fcltt_clasifi_code = #{arg1}
		and trial_fcltt_sbcls_code = #{arg2}
	</select>

	<!-- 공고 등록 start -->
	<insert id="announceRegistTB002" parameterType="AnnounceVO">

		insert into
		TB_002
		(admin_proper_num,
		trial_fcltt_proper_num,
		announce_title,
		announce_content,
		announce_start_date,
		announce_end_date)
		values
		(#{admin_proper_num},
		#{trial_fcltt_proper_num},
		#{announce_title},
		#{announce_content},
		#{announce_start_date},
		#{announce_end_date})
	</insert>

	<!-- 공고 상세보기 -->
	<select id="getAnnounceDetail" parameterType="int"
		resultType="AnnounceVO">
		select
		a.announce_proper_num,
		a.admin_proper_num,
		b.admin_id,
		b.admin_pw,
		b.admin_auth,
		b.admin_name,
		a.trial_fcltt_proper_num,
		c.trial_fcltt_main_code,
		c.trial_fcltt_clasifi_code,
		c.trial_fcltt_sbcls_code,
		c.trial_fcltt_description,
		a.announce_title,
		a.announce_content,
		a.announce_start_date,
		a.announce_end_date,
		a.announce_first_date,
		a.announce_last_date
		from TB_002 a
		inner join
		TB_015 b on a.admin_proper_num = b.admin_proper_num
		inner join tb_010 c
		on a.trial_fcltt_proper_num = c.trial_fcltt_proper_num
		where
		a.announce_proper_num = #{announce_proper_num};
	</select>

	<!-- 공고 수정 -->
	<select id="getAnnounceModify" parameterType="int"
		resultType="AnnounceVO">
		select
		a.announce_proper_num,
		a.admin_proper_num,
		b.admin_id,
		b.admin_pw,
		b.admin_auth,
		b.admin_name,
		a.trial_fcltt_proper_num,
		c.trial_fcltt_main_code,
		c.trial_fcltt_clasifi_code,
		c.trial_fcltt_sbcls_code,
		c.trial_fcltt_description,
		a.announce_title,
		a.announce_content,
		a.announce_start_date,
		a.announce_end_date,
		a.announce_first_date,
		a.announce_last_date
		from TB_002 a
		inner join
		TB_015 b on a.admin_proper_num = b.admin_proper_num
		inner join tb_010 c
		on a.trial_fcltt_proper_num = c.trial_fcltt_proper_num
		where
		a.announce_proper_num = #{announce_proper_num};
	</select>

	<!-- 공고 수정 -->
	<update id="updateAnnounce" parameterType="AnnounceVO">
		update TB_002
		set
		announce_title = #{announce_title},
		trial_fcltt_proper_num = #{trial_fcltt_proper_num},
		announce_start_date = #{announce_start_date},
		announce_end_date = #{announce_end_date},
		announce_content = #{announce_content}
		where
		announce_proper_num = #{announce_proper_num}
	</update>
</mapper>